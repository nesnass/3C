<md-tab-group>

  <md-tab label="Groupings">

    <div fxLayout="row wrap">
      <md-card *ngFor="let grouping of listingService.groupingsReverseSortedByCreationDate | async; let i=index;" class="grouping-card">

        <div *ngIf="itemToEdit !== i">
          <md-card-header>
            <div md-card-avatar>
              <md-icon md-list-icon>folder</md-icon>
            </div>
            <md-card-title>{{grouping.categoryTitle}}</md-card-title>
            <md-card-subtitle>{{grouping.categorySubtitle}}</md-card-subtitle>
          </md-card-header>
          <md-card-content>
            <p><a href="{{ siteUrl() + 'display/' + grouping.urlSlug}}" target="none">{{ siteUrl() }}display/<strong>{{grouping.urlSlug}}</strong></a></p>
            <p>Display Mode: <strong>{{grouping.displayMode}}</strong></p>
            <p>Contribution selection: <strong>{{grouping.contributionMode}}</strong></p>
          </md-card-content>
          <md-card-actions>
            <button md-line md-button (click)="itemToEdit = i">Edit</button>
            <button md-line md-button color="red" (click)="deleteAtServer(grouping)">Delete</button>
          </md-card-actions>
        </div>

        <div *ngIf="itemToEdit === i">
          <md-card-content fxLayout="column">
            <md-input-container>
              <input mdInput placeholder="Category Title" [(ngModel)]="grouping.categoryTitle" autofocus>
            </md-input-container>
            <md-input-container>
              <input mdInput placeholder="Category Subtitle" [(ngModel)]="grouping.categorySubtitle">
            </md-input-container>
            <md-input-container>
              <input mdInput placeholder="URL" [(ngModel)]="grouping.urlSlug">
            </md-input-container>
            <md-select placeholder="Present view as" [(ngModel)]="grouping.displayMode">
              <md-option *ngFor="let mode of displayModes" [value]="mode.viewValue">
                {{ mode.viewValue }}
              </md-option>
            </md-select>
            <br>
            <md-select placeholder="Select Contributions using" [(ngModel)]="grouping.contributionMode">
              <md-option *ngFor="let mode of contributionModes" [value]="mode.viewValue">
                {{ mode.viewValue }}
              </md-option>
            </md-select>
            <div *ngIf="grouping.contributionMode === 'Chips'">
              <p>Show content tagged with:</p>
              <md-chip-list>
                <md-basic-chip class="custom-chip" *ngFor="let chip of listingService.chips" [ngStyle]="chipStyle(chip, grouping)" [selected]="grouping.chips.indexOf(chip._id) > -1" (click)="toggleChip(grouping, 'Grouping', chip)">{{chip.label}}</md-basic-chip>
              </md-chip-list>
            </div>
          </md-card-content>

          <md-card-actions>
            <button md-button (click)="updateToServer(grouping, 'Grouping'); itemToEdit = -1">Done</button>
          </md-card-actions>
        </div>

      </md-card>

      <md-card class="grouping-card">
        <md-card-header>
          <md-card-title><a md-button (click)="addGrouping()"><md-icon md-list-icon>add</md-icon>New Grouping</a></md-card-title>
        </md-card-header>
        <md-card-content></md-card-content>
      </md-card>

    </div>
  </md-tab>


  <md-tab label="Contributions">

    <div fxLayout="row wrap">
      <md-card *ngFor="let contribution of listingService.contributions | async" class="contribution-card">
        <md-card-header>
          <div md-card-avatar class="contribution-card-header-image" [ngStyle]="{'background-image': 'url(\'' + contribution.user.profile_picture + '\')' }"></div>
          <md-card-title>{{contribution.user.username}}</md-card-title>
          <md-card-subtitle>{{contribution.created.toString()}}</md-card-subtitle>
        </md-card-header>
        <img md-card-image [src]="contribution.image.url" alt="The contributed image">
        <md-card-content>
          <p>{{contribution.caption}}</p>
          <md-chip-list>
            <md-basic-chip class="custom-chip" *ngFor="let chip of listingService.chips" [ngStyle]="chipStyle(chip, contribution)" [selected]="contribution.chips.indexOf(chip._id) > -1" (click)="toggleChip(contribution, 'Contribution', chip)">{{chip.label}}</md-basic-chip>
          </md-chip-list>
        </md-card-content>
      </md-card>
    </div>

  </md-tab>

  <md-tab label="Chips">

    <div fxLayout="row wrap">
      <md-card *ngFor="let chip of listingService.chips" class="chip-card">
        <md-card-header>
          <div md-card-avatar class="contribution-card-header-image" [ngStyle]="chipStyle(chip)"></div>
          <md-card-title>{{chip.label}}</md-card-title>
          <md-card-subtitle>{{chip.origin}}</md-card-subtitle>
        </md-card-header>
        <md-card-content>

        </md-card-content>
      </md-card>
    </div>

  </md-tab>

</md-tab-group>
